# Default values for cluster-storage
# This chart manages the central storage configuration for local-path-provisioner

localPathProvisioner:
  # Namespace where the provisioner is deployed
  # Options: kube-system (k3s default) or local-path-storage (manual deployment)
  namespace: kube-system
  
  # Storage path on nodes
  storagePath: "/var/lib/rancher/k3s/storage"
  
  # ConfigMap configuration
  configMap:
    name: local-path-config
    helperPod:
      image: ""  # Will be set via --set in workflow (ACR_REGISTRY/busybox:1.36)
      imagePullPolicy: IfNotPresent
    setup: |
      #!/bin/sh
      set -eu
      mkdir -p "$VOL_DIR"
      chmod 0777 "$VOL_DIR"
    teardown: |
      #!/bin/sh
      set -eu
      rm -rf "$VOL_DIR"

# RBAC configuration for project access
rbac:
  # ClusterRole for projects to read the ConfigMap
  clusterRole:
    enabled: true
    name: local-path-config-reader
  
  # List of namespaces that should have access (optional, can be managed per-project)
  projectAccess:
    enabled: false
    namespaces: []
    # Example:
    # namespaces:
    #   - database-infrastructure
    #   - app-namespace

# StorageClass configuration
storageClass:
  enabled: true
  name: local-path
  provisioner: rancher.io/local-path
  isDefault: true
  volumeBindingMode: WaitForFirstConsumer
  reclaimPolicy: Delete
  allowVolumeExpansion: false

